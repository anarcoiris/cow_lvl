[2025-10-01 15:09:36] INFO root: init_logging: logfile=logs\log_20251001_130936.txt
[2025-10-01 15:09:36] INFO __main__: Logging initialized
[2025-10-01 15:09:39] INFO root: Config loaded from config\gui_config.json
[2025-10-01 15:10:04] INFO root: Preview loaded: 200 rows.
[2025-10-01 15:10:07] INFO root: Preview loaded: 200 rows.
[2025-10-01 15:14:04] INFO root: Prepare: loading data from sqlite...
[2025-10-01 15:14:04] INFO root: Prepare thread started.
[2025-10-01 15:14:05] INFO root: Loaded 106317 rows from sqlite.
[2025-10-01 15:14:05] INFO root: Computed features. Shape: (106317, 47)
[2025-10-01 15:14:05] INFO root: dropna: before=106317, after=106268, removed=49
[2025-10-01 15:14:05] INFO root: Feature cols selected (18): ['log_close', 'log_ret_1', 'log_ret_5', 'ema_5', 'ema_20', 'ema_50', 'bb_m', 'bb_width', 'rsi_14', 'atr_14', 'dist_fib_r_236', 'dist_fib_r_382', 'dist_fib_r_618', 'dist_fib_r_786', 'dist_fibext_1272', 'dist_fibext_1618', 'td_buy_setup', 'td_sell_setup']
[2025-10-01 15:14:05] INFO root: Building sequences...
[2025-10-01 15:14:10] INFO root: Sequences built: N=106121, seq_len=128, features=18
[2025-10-01 15:14:13] INFO root: Scaler fitted and df_scaled prepared.
[2025-10-01 15:14:13] INFO root: Preview raw (first 5 rows):
   id   symbol timeframe          ts       open       high        low      close     volume  source     created_at     updated_at                 timestamp
0   1  BTCUSDT        1m  1752231240  118117.79  118129.59  118090.00  118093.63    9.27987  influx  1759186315000  1759186315000 2025-07-11 10:54:00+00:00
1   2  BTCUSDT        1m  1752231300  118093.63  118093.63  117980.00  117980.01  111.28787  influx  1759186315000  1759186315000 2025-07-11 10:55:00+00:00
2   3  BTCUSDT        1m  1752231360  117980.00  118023.34  117980.00  118022.39    9.13797  influx  1759186315000  1759186315000 2025-07-11 10:56:00+00:00
3   4  BTCUSDT        1m  1752231420  118022.38  118022.38  117946.72  117968.01   30.41224  influx  1759186315000  1759186315000 2025-07-11 10:57:00+00:00
4   5  BTCUSDT        1m  1752231480  117968.01  117968.01  117964.71  117964.72    7.69926  influx  1759186315000  1759186315000 2025-07-11 10:58:00+00:00
[2025-10-01 15:14:13] INFO root: Preview features (first 5 rows):
           close           high            low  log_close     ret_1  log_ret_1     ret_5  log_ret_5          sma_5         sma_20         sma_50          ema_5         ema_20         ema_50  ma_diff_20           bb_m     bb_std          bb_up          bb_dn  bb_width     rsi_14     atr_14  raw_vol_10  raw_vol_30      fib_r_236  dist_fib_r_236      fib_r_382  dist_fib_r_382      fib_r_500  dist_fib_r_500      fib_r_618  dist_fib_r_618      fib_r_786  dist_fib_r_786   fibext_1272  dist_fibext_1272    fibext_1618  dist_fibext_1618    fibext_2000  dist_fibext_2000  td_buy_setup  td_sell_setup    volume           timestamp       open   symbol timeframe
0  117783.406250  117802.007812  117783.406250  11.676602 -0.000158  -0.000158  0.000130   0.000130  117794.093750  117726.835938  117817.375000  117788.960938  117759.851562  117815.523438   56.574001  117726.835938  62.577103  117851.992188  117601.679688  0.002126  74.286270  28.154285    0.000165    0.000244  117712.117188        0.130470  117791.898438       -0.015530  117856.375000       -0.133530  117920.851562       -0.251530  118012.656250       -0.419530  118278.21875         -0.905530  118467.281250         -1.251530  118676.023438         -1.633530             1              0   9.38562 2025-07-11 11:43:00  117802.00  BTCUSDT        1m
1  117763.007812  117783.421875  117751.218750  11.676430 -0.000173  -0.000173 -0.000181  -0.000181  117789.820312  117732.296875  117810.757812  117780.312500  117760.156250  117813.460938   30.714001  117732.296875  60.602898  117853.500000  117611.093750  0.002059  63.416958  25.852142    0.000176    0.000238  117707.632812        0.104987  117784.640625       -0.041013  117846.882812       -0.159013  117909.117188       -0.277013  117997.726562       -0.445013  118254.06250         -0.931013  118436.554688         -1.277013  118638.039062         -1.659013             2              0   8.65069 2025-07-11 11:44:00  117783.42  BTCUSDT        1m
2  117740.632812  117763.007812  117727.843750  11.676239 -0.000190  -0.000190 -0.000493  -0.000493  117778.210938  117738.859375  117805.968750  117767.085938  117758.296875  117810.609375    1.772500  117738.859375  53.255333  117845.367188  117632.343750  0.001809  59.572964  27.683571    0.000189    0.000234  117707.632812        0.062555  117784.640625       -0.083445  117846.882812       -0.201445  117909.117188       -0.319445  117997.726562       -0.487445  118254.06250         -0.973445  118436.554688         -1.319445  118638.039062         -1.701445             3              0  12.10969 2025-07-11 11:45:00  117763.01  BTCUSDT        1m
3  117710.046875  117740.632812  117710.046875  11.675980 -0.000260  -0.000260 -0.000781  -0.000781  117759.820312  117743.359375  117799.726562  117748.070312  117753.703125  117806.664062  -33.310501  117743.359375  45.987026  117835.335938  117651.382812  0.001562  48.687981  24.362858    0.000138    0.000239  117707.632812        0.004577  117784.640625       -0.141423  117846.882812       -0.259423  117909.117188       -0.377423  117997.726562       -0.545423  118254.06250         -1.031423  118436.554688         -1.377423  118638.039062         -1.759423             4              0   9.20696 2025-07-11 11:46:00  117740.63  BTCUSDT        1m
4  117700.007812  117710.062500  117700.000000  11.675895 -0.000085  -0.000085 -0.000866  -0.000866  117739.421875  117744.781250  117794.367188  117732.054688  117748.585938  117802.476562  -44.774502  117744.781250  44.045681  117832.875000  117656.695312  0.001496  39.702305  22.860714    0.000137    0.000233  117707.632812       -0.014458  117784.640625       -0.160458  117846.882812       -0.278458  117909.117188       -0.396458  117997.726562       -0.564458  118254.06250         -1.050458  118436.554688         -1.396458  118638.039062         -1.778458             5              0  10.32029 2025-07-11 11:47:00  117710.06  BTCUSDT        1m
[2025-10-01 15:14:13] INFO root: Preview scaled (first 5 rows):
           close           high            low  log_close     ret_1  log_ret_1     ret_5  log_ret_5          sma_5         sma_20         sma_50     ema_5    ema_20    ema_50  ma_diff_20      bb_m     bb_std          bb_up          bb_dn  bb_width    rsi_14    atr_14  raw_vol_10  raw_vol_30      fib_r_236  dist_fib_r_236      fib_r_382  dist_fib_r_382      fib_r_500  dist_fib_r_500      fib_r_618  dist_fib_r_618      fib_r_786  dist_fib_r_786   fibext_1272  dist_fibext_1272    fibext_1618  dist_fibext_1618    fibext_2000  dist_fibext_2000  td_buy_setup  td_sell_setup    volume           timestamp       open   symbol timeframe
0  117783.406250  117802.007812  117783.406250   0.656078 -0.000158  -0.360311  0.000130   0.135470  117794.093750  117726.835938  117817.375000  0.655025  0.646021  0.663965   56.574001  0.635468  62.577103  117851.992188  117601.679688 -0.185738  1.292780 -0.492212    0.000165    0.000244  117712.117188       -0.442262  117791.898438       -0.442262  117856.375000       -0.133530  117920.851562       -0.442262  118012.656250       -0.442262  118278.21875         -0.442262  118467.281250         -0.442263  118676.023438         -1.633530     -0.339590      -0.637061   9.38562 2025-07-11 11:43:00  117802.00  BTCUSDT        1m
1  117763.007812  117783.421875  117751.218750   0.649823 -0.000173  -0.395341 -0.000181  -0.183987  117789.820312  117732.296875  117810.757812  0.652295  0.646117  0.663313   30.714001  0.637192  60.602898  117853.500000  117611.093750 -0.218656  0.712103 -0.562266    0.000176    0.000238  117707.632812       -0.521744  117784.640625       -0.521744  117846.882812       -0.159013  117909.117188       -0.521744  117997.726562       -0.521744  118254.06250         -0.521744  118436.554688         -0.521743  118638.039062         -1.659013     -0.044871      -0.637061   8.65069 2025-07-11 11:44:00  117783.42  BTCUSDT        1m
2  117740.632812  117763.007812  117727.843750   0.642911 -0.000190  -0.433889 -0.000493  -0.504600  117778.210938  117738.859375  117805.968750  0.648120  0.645530  0.662412    1.772500  0.639265  53.255333  117845.367188  117632.343750 -0.341035  0.506744 -0.506536    0.000189    0.000234  117707.632812       -0.654087  117784.640625       -0.654087  117846.882812       -0.201445  117909.117188       -0.654087  117997.726562       -0.654087  118254.06250         -0.654087  118436.554688         -0.654086  118638.039062         -1.701445      0.249848      -0.637061  12.10969 2025-07-11 11:45:00  117763.01  BTCUSDT        1m
3  117710.046875  117740.632812  117710.046875   0.633511 -0.000260  -0.593364 -0.000781  -0.800764  117759.820312  117743.359375  117799.726562  0.642117  0.644079  0.661164  -33.310501  0.640686  45.987026  117835.335938  117651.382812 -0.462069 -0.074770 -0.607585    0.000138    0.000239  117707.632812       -0.834920  117784.640625       -0.834920  117846.882812       -0.259423  117909.117188       -0.834920  117997.726562       -0.834920  118254.06250         -0.834920  118436.554688         -0.834920  118638.039062         -1.759423      0.544566      -0.637061   9.20696 2025-07-11 11:46:00  117740.63  BTCUSDT        1m
4  117700.007812  117710.062500  117700.000000   0.630436 -0.000085  -0.194177 -0.000866  -0.888472  117739.421875  117744.781250  117794.367188  0.637061  0.642463  0.659841  -44.774502  0.641135  44.045681  117832.875000  117656.695312 -0.494396 -0.554816 -0.653295    0.000137    0.000233  117707.632812       -0.894291  117784.640625       -0.894291  117846.882812       -0.278458  117909.117188       -0.894291  117997.726562       -0.894291  118254.06250         -0.894291  118436.554688         -0.894291  118638.039062         -1.778458      0.839285      -0.637061  10.32029 2025-07-11 11:47:00  117710.06  BTCUSDT        1m
[2025-10-01 15:14:13] INFO root: Prepare stage finished successfully.
[2025-10-01 15:15:28] INFO root: Training thread started.
[2025-10-01 15:15:50] INFO root: Applied scaler to sequences for training.
[2025-10-01 15:15:50] INFO root: Using device: cuda
[2025-10-01 15:16:02] INFO root: [Train] Epoch 1/250 train_loss=0.014506 val_loss=0.012385
[2025-10-01 15:16:02] INFO root: Saving artifacts failed: expected floating-point number but got "z"
[2025-10-01 15:16:09] INFO root: [Train] Epoch 2/250 train_loss=0.013562 val_loss=0.011454
[2025-10-01 15:16:09] INFO root: Saving artifacts failed: expected floating-point number but got "z"
[2025-10-01 15:16:10] CRITICAL root: Uncaught exception
Traceback (most recent call last):
  File "C:\Users\soyko\Documents\git2\Market\project assistant\env.model_0.9\0.9f\fibopkg5\trading_gui_extended.py", line 2697, in <module>
    main()
  File "C:\Users\soyko\Documents\git2\Market\project assistant\env.model_0.9\0.9f\fibopkg5\trading_gui_extended.py", line 2693, in main
    root.mainloop()
  File "C:\Users\soyko\AppData\Local\Programs\Python\Python310\lib\tkinter\__init__.py", line 1458, in mainloop
    self.tk.mainloop(n)
KeyboardInterrupt
